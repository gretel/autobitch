# tom hensel <github@jitter.eu> 2016
# powered by https://github.com/zimbatm/direnv
# -*- mode: bash; coding:utf-8; tab-width: 2; indent-tabs-mode: nil; -*-

set -e
set -o posix

### automagic
###
### important: 
###   call the use_auto_* functions late -
###   otherwise PATH might not be populated!
### note:
###   calling the functions directly (instead of the 'use' wrapper)
###   is done to prevent verbose logging. this is subject to change.
###
### add the bin directory next to this file if exist to have the
### containing binaries available in PATH
test -d "bin" && PATH_add "bin"

### decorate log output
auto_log_prefix "$(expand_path "$1")"

### argument: pass $1 to keep the current context
use_auto_ruby "$1"
use_auto_python "$1"

### watch files for changes and reload direnv eventually
watch_file ".ruby-version"
watch_file ".python-venv"
watch_file ".python-version"

### watch fish configuration as it exports environment variables
watch_file ".config/fish/config.fish"
watch_file ".config/fish/local.fish"

### watch directories containing the toolchains to automagic
watch_file "$HOME/.pyenv/versions"
watch_file "$HOME/.rubies"
